<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Complete Environmental Footprints Along Supply Chains — calculate_footprints • afsetools</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Complete Environmental Footprints Along Supply Chains — calculate_footprints"><meta name="description" content="Main workflow function that traces environmental footprints through global supply chains,
from primary production through processing, feed, and final products. This function
orchestrates the entire footprint calculation process and returns all intermediate
and final footprint data frames."><meta property="og:description" content="Main workflow function that traces environmental footprints through global supply chains,
from primary production through processing, feed, and final products. This function
orchestrates the entire footprint calculation process and returns all intermediate
and final footprint data frames."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">afsetools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eduaguilera/afsetools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate Complete Environmental Footprints Along Supply Chains</h1>
      <small class="dont-index">Source: <a href="https://github.com/eduaguilera/afsetools/blob/main/R/calculate_footprints.R" class="external-link"><code>R/calculate_footprints.R</code></a></small>
      <div class="d-none name"><code>calculate_footprints.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Main workflow function that traces environmental footprints through global supply chains,
from primary production through processing, feed, and final products. This function
orchestrates the entire footprint calculation process and returns all intermediate
and final footprint data frames.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate_footprints</span><span class="op">(</span></span>
<span>  <span class="va">cbs</span>,</span>
<span>  <span class="va">primary</span>,</span>
<span>  <span class="va">impact_prod</span>,</span>
<span>  <span class="va">crop_nppr</span>,</span>
<span>  <span class="va">feed_intake</span>,</span>
<span>  dtm <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-cbs">cbs<a class="anchor" aria-label="anchor" href="#arg-cbs"></a></dt>
<dd><p>Commodity Balance Sheets table. Required columns: <code>Year</code>, <code>area</code>,
<code>area_code</code>, <code>item</code>, <code>item_code</code>, <code>Element</code>, <code>Value</code>.
This function uses at least the following <code>Element</code> values:
<code>Production</code>, <code>Import</code>, <code>Export</code>, <code>Seed</code>,
<code>Processing</code>, and <code>Domestic_supply</code>.</p></dd>


<dt id="arg-primary">primary<a class="anchor" aria-label="anchor" href="#arg-primary"></a></dt>
<dd><p>Primary production / co-product table (new schema). Required
columns: <code>Year</code>, <code>area</code>, <code>area_code</code>, <code>item_prod</code>,
<code>item_code_prod</code>, <code>unit</code>, <code>Value</code>, <code>item_cbs</code>,
<code>item_code_cbs</code>, <code>Live_anim</code>, <code>Live_anim_code</code>,
<code>Relative_residue_price</code>. The workflow expects <code>unit == "tonnes"</code>
rows and (for draught allocation) <code>unit == "LU"</code> livestock rows.</p></dd>


<dt id="arg-impact-prod">impact_prod<a class="anchor" aria-label="anchor" href="#arg-impact-prod"></a></dt>
<dd><p>Production impact table (new schema). Required columns:
<code>Year</code>, <code>area</code>, <code>item_prod</code>, <code>item_code_prod</code>,
<code>Impact</code>, <code>Value</code>, <code>u_FU</code>. <code>Value</code> is treated as the
functional unit amount (<code>FU</code>) when joining production impacts to primary
production.</p></dd>


<dt id="arg-crop-nppr">crop_nppr<a class="anchor" aria-label="anchor" href="#arg-crop-nppr"></a></dt>
<dd><p>Crop NPP / residue table. Required columns: <code>Year</code>,
<code>area</code>, <code>item_prod</code>, <code>item_cbs</code>, <code>Product_residue</code>,
<code>Prod_ygpit_Mg</code>. Residue flows are taken from rows where
<code>Product_residue == "Residue"</code>.</p></dd>


<dt id="arg-feed-intake">feed_intake<a class="anchor" aria-label="anchor" href="#arg-feed-intake"></a></dt>
<dd><p>Feed intake table (new schema). Required columns:
<code>Year</code>, <code>area</code>, <code>area_code</code>, <code>Live_anim</code>,
<code>item_cbs</code>, <code>item_code_cbs</code>, <code>Supply</code>, <code>Intake_DM</code>.</p></dd>


<dt id="arg-dtm">dtm<a class="anchor" aria-label="anchor" href="#arg-dtm"></a></dt>
<dd><p>Optional detailed trade matrix. If <code>NULL</code> (default), the
function uses gross-trade mode (<code><a href="calc_avail_fp_gt.html">calc_avail_fp_gt()</a></code>). If provided, it
automatically uses detailed bilateral trade mode (<code><a href="calc_avail_fp_dtm.html">calc_avail_fp_dtm()</a></code>).
Required columns when provided: <code>Year</code>, <code>area_code</code>,
<code>area_code_p</code>, <code>area_p</code>, <code>item_code</code>, <code>Element</code>,
<code>Impact</code>, <code>Country_share</code> (with <code>Element == "Import"</code> rows
used).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A named list of intermediate and final footprint tables, including:
<code>FP_prim</code>, <code>FP_prim_i</code>, <code>FP_prim_i_global</code>, <code>FP_prim_ds</code>,
<code>FP_prim_ds_i</code>, <code>FP_processed_raw</code>, <code>FP_processed_raw_i</code>,
<code>FP_processed_ds</code>, <code>FP_processed_ds_i</code>, <code>FP_reprocessed_raw</code>,
<code>FP_reprocessed_raw_i</code>, <code>FP_raw_all</code>, <code>FP_feed_raw</code>,
<code>FP_feed</code>, <code>FP_feed_i</code>, <code>FP_feed_ds</code>, <code>FP_feed_ds_i</code>,
<code>FP_ioc</code>, <code>FP_i</code>, <code>FP_final</code>, <code>Seed_share</code>,
<code>draught_shares</code>, <code>Import_share</code>, and <code>Processing_shares</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function implements a complete footprint accounting system that:</p><ul><li><p>Calculates seed shares and removes them from production</p></li>
<li><p>Allocates impacts to co-products using economic allocation</p></li>
<li><p>Traces impacts through processing chains</p></li>
<li><p>Accounts for international trade (gross trade when <code>dtm</code> is <code>NULL</code>, bilateral trade matrix when <code>dtm</code> is provided)</p></li>
<li><p>Handles feed products and livestock production</p></li>
<li><p>Allocates draught animal services to crop production</p></li>
</ul><p>The calculation requires that `load_general_data()` has been called first to load
all necessary coefficient tables and classification data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://eduaguilera.github.io/afsetools">afsetools</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="load_general_data.html">load_general_data</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate footprints using gross trade (omit dtm)</span></span></span>
<span class="r-in"><span><span class="va">footprints</span> <span class="op">&lt;-</span> <span class="fu">calculate_footprints</span><span class="op">(</span></span></span>
<span class="r-in"><span>  cbs <span class="op">=</span> <span class="va">my_cbs_data</span>,</span></span>
<span class="r-in"><span>  primary <span class="op">=</span> <span class="va">my_primary_data</span>,</span></span>
<span class="r-in"><span>  impact_prod <span class="op">=</span> <span class="va">my_impact_data</span>,</span></span>
<span class="r-in"><span>  crop_nppr <span class="op">=</span> <span class="va">my_npp_data</span>,</span></span>
<span class="r-in"><span>  feed_intake <span class="op">=</span> <span class="va">my_feed_intake</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To use bilateral trade, pass dtm = my_dtm_data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access individual footprint tables</span></span></span>
<span class="r-in"><span><span class="va">fp_primary</span> <span class="op">&lt;-</span> <span class="va">footprints</span><span class="op">$</span><span class="va">FP_prim</span></span></span>
<span class="r-in"><span><span class="va">fp_final</span> <span class="op">&lt;-</span> <span class="va">footprints</span><span class="op">$</span><span class="va">FP_final</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://orcid.org/0000-0002-0429-0883" class="external-link">Eduardo Aguilera</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

